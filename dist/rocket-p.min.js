/*! rocket-p 2014-12-22 */
!function(a,b){"function"==typeof define&&define.amd?define(["zepto","exports"],function(c,d){b(a,d,c)}):a.Rocket=b(a,{},a.Zepto||a.jQuery)}(this,function(a,b,c){function d(a,b){function c(a,b){return function(){var c=this._super;this._super=f.prototype[a]||function(){};var d=b.apply(this,arguments);return this._super=c,d}}var d,f=this;d=a&&e.has(a,"constructor")?a.constructor:function(){return f.apply(this,arguments)},e.extend(d,f,b);var g=function(){this.constructor=d};if(g.prototype=f.prototype,d.prototype=new g,a)for(var h in a)d.prototype[h]="function"==typeof a[h]&&"function"==typeof f.prototype[h]?c(h,a[h]):a[h];return d._superClass=f,d}var e=function(){function a(a){var b=typeof a;return"function"===b||"object"===b&&!!a}function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===E.call(a)}function d(a){return"[object Function]"===E.call(a)}function f(a){return"[object String]"===E.call(a)}function g(a){return"[object Arguments]"===E.call(a)}function h(a){return"[object RegExp]"===E.call(a)}function i(a){if(null==a)return!0;if(b(a)||f(a)||g(a))return 0===a.length;for(var c in a)if(v(a,c))return!1;return!0}function j(a,b,c,e){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;var f=E.call(a);if(f!==E.call(b))return!1;switch(f){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var g="[object Array]"===f;if(!g){if("object"!=typeof a||"object"!=typeof b)return!1;var h=a.constructor,i=b.constructor;if(h!==i&&!(d(h)&&h instanceof h&&d(i)&&i instanceof i)&&"constructor"in a&&"constructor"in b)return!1}for(var k=c.length;k--;)if(c[k]===a)return e[k]===b;if(c.push(a),e.push(b),g){if(k=a.length,k!==b.length)return!1;for(;k--;)if(!j(a[k],b[k],c,e))return!1}else{var l,m=w(a);if(k=m.length,w(b).length!==k)return!1;for(;k--;)if(l=m[k],!v(b,l)||!j(a[l],b[l],c,e))return!1}return c.pop(),e.pop(),!0}function k(a,b){return j(a,b,[],[])}function l(a,b,c){var e,f={};if(null==a)return f;if(d(b)){b=I(b,c);for(e in a){var g=a[e];b(g,e,a)&&(f[e]=g)}}else{var h=m(arguments,!1,!1,1);a=new Object(a);for(var i=0,j=h.length;j>i;i++)e=h[i],e in a&&(f[e]=a[e])}return f}function m(a,c,d,e){for(var f,h=[],i=0,j=e||0,k=a&&a.length;k>j;j++)if(f=a[j],f&&f.length>=0&&(b(f)||g(f))){c||(f=m(f,c,d));var l=0,n=f.length;for(h.length+=n;n>l;)h[i++]=f[l++]}else d||(h[i++]=f);return h}function n(a,b){return m(a,b,!1)}function o(a,b,c){if(null==a)return a;b=I(b,c);var d,e=a.length;if(e===+e)for(d=0;e>d;d++)b(a[d],d,a);else{var f=w(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a}function p(a){for(var b=w(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d}function q(b,c,e){return null==b?F:d(b)?I(b,c,e):a(b)?G(b):H(b)}function r(a,b,c){if(null==a)return[];b=q(b,c);for(var d,e=a.length!==+a.length&&w(a),f=(e||a).length,g=Array(f),h=0;f>h;h++)d=e?e[h]:h,g[h]=b(a[d],d,a);return g}function s(a,b,c){if(null==a)return!1;b=q(b,c);var d,e,f=a.length!==+a.length&&w(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,b(a[e],e,a))return!0;return!1}function t(c){return a(c)?b(c)?c.slice():J({},c):c}function u(b){if(!a(b))return b;for(var c=1,d=arguments.length;d>c;c++){var e=arguments[c];for(var f in e)void 0===b[f]&&(b[f]=e[f])}return b}function v(a,b){return null!=a&&Object.prototype.hasOwnProperty.call(a,b)}function w(b){if(!a(b))return[];if(Object.keys)return Object.keys(b);var c=[];for(var d in b)v(b,d)&&c.push(d);return c}function x(b){if(!a(b))return[];var c=[];for(var d in b)c.push(d);return c}function y(a){return function(b){var c=arguments.length;if(2>c||null==b)return b;for(var d=0;c>d;d++)for(var e=arguments[d],f=a(e),g=f.length,h=0;g>h;h++){var i=f[h];b[i]=e[i]}return b}}function z(a,b,c){var e=null==a?void 0:a[b];return void 0===e&&(e=c),d(e)?e.call(a):e}function A(a){var b=++K+"";return a?a+b:b}function B(){return c.ajax.apply(c,arguments)}function C(a,b,c){var d=L[a];M.method=a,M.model=b,M.options=c,e.defaults(c||(c={}),{emulateHTTP:!1,emulateJSON:!1});var f={type:d,dataType:"json"};if(c.url||(f.url=z(b,"url")||D()),null!=c.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(f.contentType="application/json",f.data=JSON.stringify(c.attrs||b.toJSON(c))),c.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===d)){f.type="POST",c.emulateJSON&&(f.data._method=d);var g=c.beforeSend;c.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",d),g?g.apply(this,arguments):void 0}}"GET"!==f.type&&(f.processData=!1);var h=c.error;c.error=function(a,b,d){c.textStatus=b,c.errorThrown=d,h&&h.apply(this,arguments)},M.ajaxData=f.data;var i=c.xhr=e.ajax(J(f,c));return b.trigger("request",b,i,c),i}function D(){throw new Error('A "url" property or function must be specified')}var E=Object.prototype.toString,F=function(a){return a},G=function(a){var b=p(a),c=b.length;return function(a){if(null==a)return!c;a=new Object(a);for(var d=0;c>d;d++){var e=b[d],f=e[0];if(e[1]!==a[f]||!(f in a))return!1}return!0}},H=function(a){return function(b){return null==b?void 0:b[a]}},I=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},J=y(x),K=0,L={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"},M={};return{isObject:a,isFunction:d,isArray:b,isEqual:k,isEmpty:i,isRegExp:h,keys:w,defaults:u,extend:J,result:z,pick:l,flatten:n,each:o,map:r,any:s,clone:t,has:v,uniqueId:A,ajax:B,sync:C,syncArgs:M}}(),f=function(){function a(a,b,c,e){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(e));return!1}if(d.test(c)){for(var g=c.split(d),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(e));return!1}return!0}function b(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}}var c=[].slice,d=/\s+/,f={on:function(b,c,d){if(!a(this,"on",b,[c,d])||!c)return this;this._events||(this._events={});var e=this._events[b]||(this._events[b]=[]);return e.push({callback:c,context:d,ctx:d||this}),this},once:function(b,c,d){if(!a(this,"once",b,[c,d])||!c)return this;var e=this,f=function(){e.off(b,f),c.apply(this,arguments)};return f._callback=c,this.on(b,f,d)},off:function(b,c,d){if(!this._events||!a(this,"off",b,[c,d]))return this;if(!b&&!c&&!d)return this._events=void 0,this;for(var f=b?[b]:e.keys(this._events),g=0,h=f.length;h>g;g++){b=f[g];var i=this._events[b];if(i)if(c||d){for(var j=[],k=0,l=i.length;l>k;k++){var m=i[k];(c&&c!==m.callback&&c!==m.callback._callback||d&&d!==m.context)&&j.push(m)}j.length?this._events[b]=j:delete this._events[b]}else delete this._events[b]}return this},trigger:function(d){if(!this._events)return this;var e=c.call(arguments,1);if(!a(this,"trigger",d,e))return this;var f=this._events[d],g=this._events.all;return f&&b(f,e),g&&b(g,arguments),this},listenTo:function(a,b,c){var d=this._listeningTo||(this._listeningTo={}),f=a._listenId||(a._listenId=e.uniqueId("l"));d[f]=a,c||"object"!=typeof b||(c=this),a.on(b,c,this)},listenToOnce:function(a,b,c){if("object"==typeof b){for(var d in b)this.listenToOnce(a,d,b[d]);return this}var e=function(){this.stopListening(a,b,e),c.apply(this,arguments)};return e._callback=c,this.listenTo(a,b,e)},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var f=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var g in d)a=d[g],a.off(b,c,this),(f||e.isEmpty(a._events))&&delete this._listeningTo[g];return this}};return f.bind=f.on,f.unbind=f.off,f}(),g=function(){function a(){this.handlers=[],"undefined"!=typeof window&&(this.location=window.location,this.history=window.history);var a=this,b=a.checkUrl;a.checkUrl=function(){b.apply(a,arguments)}}var b=/^[#\/]|\s+$/g,c=/^\/+|\/+$/g,d=/#.*$/;return a.started=!1,e.extend(a.prototype,f,{interval:50,atRoot:function(){var a=this.location.pathname.replace(/[^\/]$/,"$&/");return a===this.root&&!this.getSearch()},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=decodeURI(this.location.pathname+this.getSearch()),b=this.root.slice(0,-1);return a.indexOf(b)||(a=a.slice(b.length)),"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){return null==a&&(a=this._hasPushState||!this._wantsHashChange?this.getPath():this.getHash()),a.replace(b,"")},start:function(b){if(a.started)throw new Error("history has already been started");if(a.started=!0,this.options=e.extend({root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(c,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var d=this.root.slice(0,-1)||"/";return this.location.replace(d+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!(this._hasHashChange||!this._wantsHashChange||this._wantsPushState&&this._hasPushState)){var f=document.createElement("iframe");f.src="javascript:0",f.style.display="none",f.tabIndex=-1;var g=document.body;this.iframe=g.insertBefore(f,g.firstChild).contentWindow,this.iframe.document.open().close(),this.iframe.location.hash="#"+this.fragment}var h=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};return this._hasPushState?h("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?h("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var b=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._hasPushState?b("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&b("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),a.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getHash(this.iframe)),a===this.fragment?!1:(this.iframe&&this.navigate(a),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),e.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(b,c){if(!a.started)return!1;c&&c!==!0||(c={trigger:!!c}),b=this.getFragment(b||"");var e=this.root;(""===b||"?"===b.charAt(0))&&(e=e.slice(0,-1)||"/");var f=e+b;if(b=decodeURI(b.replace(d,"")),this.fragment!==b){if(this.fragment=b,this._hasPushState)this.history[c.replace?"replaceState":"pushState"]({},document.title,f);else{if(!this._wantsHashChange)return this.location.assign(f);this._updateHash(this.location,b,c.replace),this.iframe&&b!==this.getHash(this.iframe)&&(c.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,b,c.replace))}return c.trigger?this.loadUrl(b):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),new a}(),h=function(){function a(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}var b=function(a,b){var c=a||{};b||(b={}),this.attributes={},b.parse&&(c=this.parse(c,b)||{}),c=e.defaults({},c,e.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};return e.extend(b.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return e.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},escape:function(){},get:function(a){return this.attributes[a]},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,c=b):(f={})[a]=b,c||(c={}),!this._validate(f,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=e.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(d in f)b=f[d],e.isEqual(l[d],b)||h.push(d),e.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete l[d]:l[d]=b;if(!i){h.length&&(this._pending=c);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,e.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,e.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!e.isEmpty(this.changed):e.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?e.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var f in a)e.isEqual(d[f],b=a[f])||((c||(c={}))[f]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return e.clone(this._previousAttributes)},fetch:function(b){b=b?e.clone(b):{},void 0===b.parse&&(b.parse=!0);var c=this,d=b.success;return b.success=function(a){return c.set(c.parse(a,b),b)?(d&&d(c,a,b),void c.trigger("sync",c,a,b)):!1},a(this,b),this.sync("read",this,b)},save:function(b,c,d){var f,g,h,i=this.attributes;if(null==b||"object"==typeof b?(f=b,d=c):(f={})[b]=c,d=e.extend({validate:!0},d),f&&!d.wait){if(!this.set(f,d))return!1}else if(!this._validate(f,d))return!1;f&&d.wait&&(this.attributes=e.extend({},i,f)),void 0===d.parse&&(d.parse=!0);var j=this,k=d.success;return d.success=function(a){j.attributes=i;var b=j.parse(a,d);return d.wait&&(b=e.extend(f||{},b)),e.isObject(b)&&!j.set(b,d)?!1:(k&&k(j,a,d),void j.trigger("sync",j,a,d))},a(this,d),g=this.isNew()?"create":d.patch?"patch":"update","patch"!==g||d.attrs||(d.attrs=f),h=this.sync(g,this,d),f&&d.wait&&(this.attributes=i),h},destroy:function(b){b=b?e.clone(b):{};var c=this,d=b.success,f=function(){c.stopListening(),c.trigger("destroy",c,c.collection,b)};if(b.success=function(a){(b.wait||c.isNew())&&f(),d&&d(c,a,b),c.isNew()||c.trigger("sync",c,a,b)},this.isNew())return b.success(),!1;a(this,b);var g=this.sync("delete",this,b);return b.wait||f(),g},url:function(){var a=e.result(this,"urlRoot")||e.result(this.collection,"url")||urlError();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},e.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=e.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,e.extend(b,{validationError:c})),!1):!0}}),b.extend=d,b}(),i=function(){var a=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this.history=a.history||this.history||g,this._bindRoutes(),this.initialize.apply(this,arguments)},b=/\((.*?)\)/g,c=/(\(\?)?:\w+/g,h=/\*\w+/g,i=/[\-{}\[\]+?.,\\\^$|#\s]/g;return e.extend(a.prototype,f,{initialize:function(){},route:function(a,b,c){e.isRegExp(a)||(a=this._routeToRegExp(a)),e.isFunction(b)&&(c=b,b=""),c||(c=this[b]);var d=this,f=e.result(this,"history");return f.route(a,function(e){var g=d._extractParameters(a,e);d.execute(c,g,b)!==!1&&(d.trigger.apply(d,["route:"+b].concat(g)),d.trigger("route",b,g),f.trigger("route",d,b,g))}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return e.result(this,"history").navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=e.result(this,"routes");for(var a,b=e.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(b,"(?:$1)?").replace(c,function(a,b){return b?a:"([^/?]+)"}).replace(h,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return e.map(c,function(a,b){return b===c.length-1?a||null:a?decodeURIComponent(a):null})}}),a.extend=d,a}(),j=function(){var a=["model","collection","el","id","attributes","className","tagName","events"],b=/^(\S+)\s*(.*)$/,g=function(b){this.cid=e.uniqueId("view"),b||(b={}),e.extend(this,e.pick(b,a)),this._ensureElement(),this.initialize.apply(this,arguments)};return e.extend(g.prototype,f,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(a){return this.undelegateEvents(),this._setElement(a),this.delegateEvents(),this},_setElement:function(a){this.$el=a instanceof c?a:c(a),this.el=this.$el[0]},delegateEvents:function(a){if(!a&&!(a=e.result(this,"events")))return this;this.undelegateEvents();for(var c in a){var d=a[c];if(e.isFunction(d)||(d=this[d]),d){var f=c.match(b),g=this;this.delegate(f[1],f[2],function(){d.apply(g,arguments)})}}},delegate:function(a,b,c){this.$el.on(a+".delegateEvents"+this.cid,b,c)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(a,b,c){this.$el.off(a+".delegateEvents"+this.cid,b,c)},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(this.el)this.setElement(e.result(this,"el"));else{var a=e.extend({},e.result(this,"attributes"));this.id&&(a.id=e.result(this,"id")),this.className&&(a["class"]=e.result(this,"className")),this.setElement(this._createElement(e.result(this,"tagName"))),this._setAttributes(a)}},_setAttributes:function(a){this.$el.attr(a)}}),g.extend=d,g}();return e.extend(b,{Events:f,Model:h,View:j,History:g,Router:i,Utils:e,extend:d}),b});